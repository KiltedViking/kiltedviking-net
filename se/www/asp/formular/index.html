<!DOCTYPE html>
<html lang="sv">
<head>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-5M3PC2');</script>
	<!-- End Google Tag Manager -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="Webbutveckling på svenska. Introduktion till Active Server Pages (ASP)." />
	<meta property="og:title" content="Björns studiewebb - Webbutveckling på svenska. Introduktion till Active Server Pages (ASP)." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://www.kiltedviking.net/se/www/asp/formular/" />
	<meta property="og:image" content="https://www.kiltedviking.net/se/www/bilder/logony1.jpg" />
	<link rel="canonical" href="https://www.kiltedviking.net/se/www/asp/formular/" />
  <link rel="shortcut icon" href="../../../favicon.ico" />
  <title>ASP och formulär - Bj&ouml;rns studiewebb</title>
  <link rel="stylesheet" type="text/css" href="../../stilar/gul.css">
</head>
<body>
<div class="container">
  <table>
    <tr>
      <td class="design-border"><img src="../../bilder/vitovrevanstra.gif" width="20" height="20" alt="TL"></td>
      <td class="design-border"><a name="borjan"></a>&nbsp;</td>
      <td class="design-border"><img height="20" src="../../bilder/vitovrehogra.gif" width="20" alt="TR"></td>
    </tr>
    <!-- Rad med meny --><!-- Rad med rubrik --><!-- Rad med information -->
    <tr>
      <td class="design-border">&nbsp;</td>
      <td class="design-content">
        <table width="100%">
          <tr>
            <td width="30%"><a href="../../index.html"><img
              src="../../bilder/logony1.jpg" alt="Till startsida för Björns studiewebb"
              width="155" height="54"></a></td>
            <td width="70%" class="rubrik">ASP och formulär</td>
          </tr>
          <tr valign="top">
            <td width="30%" class="design-menu">
              <h4>Innehåll</h4>
              <p><A HREF="#formularHTML" CLASS="lank"><img src="../../bilder/hpil.gif" width="8" height="10" alt="Högerpil">
              Formulär med HTML</A><BR>
              <A HREF="#hamta" CLASS="lank"><img src="../../bilder/hpil.gif" width="8" height="10" alt="Högerpil">
              Hämta information</A><BR>
              <A HREF="#storre" CLASS="lank"><img src="../../bilder/hpil.gif" width="8" height="10" alt="Högerpil">
              Större exempel</A></p>

              <p><A HREF="formularfp.html" CLASS="lank">Formulär med FP</A>
                <img src="../../bilder/hpil.gif" width="8" height="10" alt="Högerpil"></p>

              <p><A HREF="../index.html" CLASS="lank"><img src="../../bilder/vpil.gif" width="8" height="10" alt="Vänsterpil">
              Tillbaka</A> till ASP<br>
              <a href="../../index.html" class="lank"><img src="../../bilder/vpil.gif" width="8" height="10" alt="Vänsterpil">
              Till startsida</a> för studiewebb</p>
            </td>
            <td width="70%">
              <p>Denna sida innehåller en beskrivning av hur man <b> skapar formulär</b>
              med HTML-kod (som t.ex. kan skickas till en ASP-sida) samt hur man <b> hämtar informationen
              från formulär</b> i ASP-sidor.</p>

              <p>Känner du dig osäker på HTML är rekommenderad läsning, innan du
              går vidare på denna webbsida, &quot;underwebben&quot;
              <A HREF="../../html/index.html" TARGET="_blank">HTML</A>
              som mer ingående beskriver de olika kontrollerna (fälten) som förekommer
              i HTML.</p>

              <P>Formulär på webbsidor kan skapas visuellt med verktyg som
              Microsoft FrontPage (FP) eller skivas direkt i HTML-kod.</P>
            </td>
          </tr>
        </table>

        <HR>

        <H2><A NAME="formularHTML"></A>Formulär med HTML-kod</H2>

        <P>För att skapa ett formulär behövs minst tre saker:</P>

        <ul>
          <li>FORM-taggen</li>
          <li>en kontroll</li>
          <li>och en Submit-knapp.</li>
        </ul>

        <p>Dessa detaljer behandlas nedan. Har du bråttom kan du skippa till
        slutet på detta avsnitt som visar ett exempel med nödvändig kod.</p>

        <H3>FORM-taggen</H3>

        <P>FORM-taggen används för att märka upp start och slut på formulär.
        Attributen i taggen används för att tala om var formulärets innehåll
        ska skickas samt hur innehållet ska skickas. De två viktigaste
        attributen i FORM-taggen är</P>

        <UL>
          <LI>METHOD - hur formulär ska skickas: med get eller post (se nedan).</LI>
          <LI>ACTION - var formulärets innehåll ska skickas. Detta kan t.ex.
            vara ett CGI-program, en ASP-sida eller en Java-servlet.</LI>
        </UL>

        <P>Nedan visas koden för ett enkelt formulär som skickar innehållet
        till filen MINSIDA.ASP. Kontrollernas och Submit-knappens position har
        markerats med (HTML-)kommentarer.</P>

        <BLOCKQUOTE>
          <P><SPAN CLASS="kod"><B>&lt;FORM METHOD=&quot;post&quot;
            ACTION=&quot;minsida.asp&quot;&gt;</B><BR>
            &nbsp; &lt;!-- Kontroller i formulär --&gt;<BR>
            &nbsp; &lt;!-- Submit-knapp --&gt;<BR>
            <B>&lt;/FORM&gt;</B></SPAN></P>
        </BLOCKQUOTE>

        <H4>Metoderna get och post</H4>

        <P>Ett formulär kan skickas på två olika sätt: med get eller post. Den
        stora skillnaden är hur innehållet skickas och hur mycket som kan
        skickas.</P>

        <P>Metoden get är den ursprungliga (den gamla) varianten av hur man
        skickar formulär. Innehållet skickas som en del av URL:en (se exempel
        nedan) till (t.ex.)
        ASP-sida som hanterar innehållet i formuläret. Eftersom vi använder
        URL:en för att skicka innehållet så är mängden data vi kan skicka
        begränsad (127 till 255 tecken).</P>

        <blockquote>
          <P><SPAN CLASS="kod">http://www.eki.mdh.se/minsida.asp?Namn=Björn&amp;Telefon=3678</SPAN></P>
        </blockquote>

        <P>Metoden post är den nyare varianten för att skicka formulär.
        Data i formulär skickas som en del av webbläsarens begäran om
        webbsidor. Därför syns inte innehållet i URL:en. Det är också den metod
        som <b> bör</b> användas om man frågar efter ett lösenord i formuläret.
        Eftersom data skickas i begäran så är inte mängden data heller
        begränsad.</P>

        <P CLASS="kommentar"><B>Observera</B> att lösenordet fortfarande skickas
        okrypterat även om metoden post används!</P>

        <P>Att använda metoden post är alltså ett säkert kort. :-)</P>

        <H3>Kontroller</H3>

        <P>Många av de vanliga kontroller som används i t.ex. Visual Basic finns
        även i HTML:</P>

        <UL>
          <LI>textfält - en- och flerradiga</LI>
          <LI>radioknappar</LI>
          <LI>kryssrutor</LI>
          <LI>knappar</LI>
          <LI>list- och kombinationsrutor</LI>
        </UL>

        <H4>Enkla kontroller (&lt;INPUT&gt;)</H4>

        <P>De flesta av kontrollerna skapas m.h.a. INPUT-taggen (utom
        flerradiga textrutor och list-/kombinationsrutor). Kontroller som skapas
        med INPUT-taggen använder attributet TYPE för att tala om vilken typ av
        kontroll som ska skapas. I tabellen nedan visas attributet och typen av
        kontroll som skapas.</P>

        <FORM>
        <TABLE BORDER="1" WIDTH="100%">
          <TR>
            <TD WIDTH="33%" CLASS="gulfet">Typ av kontroll</TD>
            <TD WIDTH="33%" CLASS="gulfet">Värde på TYPE</TD>
            <TD WIDTH="34%" CLASS="gulfet">Exempel</TD>
          </TR>
          <TR>
            <TD WIDTH="33%" CLASS="normal">Textfält</TD>
            <TD WIDTH="33%" CLASS="normal">&quot;text&quot;</TD>
            <TD WIDTH="34%" CLASS="normal"><INPUT TYPE="text" NAME="T1" VALUE="Exempel"></TD>
          </TR>
          <TR>
            <TD WIDTH="33%" CLASS="normal">Lösenordsfält</TD>
            <TD WIDTH="33%" CLASS="normal">&quot;password&quot;</TD>
            <TD WIDTH="34%" CLASS="normal"><INPUT TYPE="password" NAME="T2" VALUE="Exempel"></TD>
          </TR>
          <TR>
            <TD WIDTH="33%" CLASS="normal">Dolt textfält</TD>
            <TD WIDTH="33%" CLASS="normal">&quot;hidden&quot;</TD>
            <TD WIDTH="34%" CLASS="normal">(syns inte :-)<INPUT TYPE="hidden" NAME="T3" VALUE="Exempel"></TD>
          </TR>
          <TR>
            <TD WIDTH="33%" CLASS="normal">Kryssruta</TD>
            <TD WIDTH="33%" CLASS="normal">&quot;check&quot;</TD>
            <TD WIDTH="34%" CLASS="normal"><INPUT TYPE="checkbox" NAME="C1" VALUE="ON"></TD>
          </TR>
          <TR>
            <TD WIDTH="33%" CLASS="normal">Radioknapp</TD>
            <TD WIDTH="33%" CLASS="normal">&quot;radio&quot;</TD>
            <TD WIDTH="34%" CLASS="normal"><INPUT TYPE="radio" VALUE="V1" CHECKED NAME="R1"></TD>
          </TR>
          <TR>
            <TD WIDTH="33%" CLASS="normal">Tryckknapp</TD>
            <TD WIDTH="33%" CLASS="normal">&quot;button&quot;</TD>
            <TD WIDTH="34%" CLASS="normal"><INPUT TYPE="button" VALUE="Exempel"></TD>
          </TR>
        </TABLE>
        </FORM>

        <h5>Attributet NAME</h5>

        <P>Gemensamt för de flesta kontroller är att man använder attributet
        NAME för att ange namnet på kontrollen. Namnet används för att
        referera till värdet i den mottagande ASP-sidan.</P>

        <P>Ett enkelt textfält med namnet &quot;mintext&quot; skulle skapas med
        följande HTML-kod:</P>

        <BLOCKQUOTE>
          <P><SPAN CLASS="kod">&lt;INPUT TYPE=&quot;text&quot;
            NAME=&quot;mintext&quot;&gt;</SPAN></P>
        </BLOCKQUOTE>

        <h5>Attributet VALUE</h5>

        <p>Vill vi ange ett värde när formuläret laddas kan vi använda
        attributet VALUE. Tex ger följande HTML-kod:</p>

        <blockquote>
          <p>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;mintext&quot; SIZE=&quot;40&quot;<br>
          &nbsp; VALUE=&quot;Text som visas när formulär laddas"></p>
        </blockquote>

        <P>följande utseende:</P>

        <BLOCKQUOTE>
          <form>
            <p><input type="text" name="mintext" size="40" value="Text som visas när formulär laddas"></p>
          </form>
        </BLOCKQUOTE>

        <H4>Flerradiga textfält (&lt;TEXTAREA&gt;)</H4>

        <P>Flerradiga textfält skiljer sig på en del punkter från de enradiga,
        bortsett från att fältet har flera rader. :-) Bl.a. så har fältet
        både en öppnande och avslutande tagg. Och attributen COLS och ROWS används
        för att ange (ungefärligen) hur många teckens bredd och höjd som
        textfältet ska visas med.</P>

        <P>Exempel på HTML-kod för ett flerradigt textfält visas nedan
        (observera att <B>allt</B> som skrivs mellan öppnande och avslutande tagg
        kommer att visas i textfältet - även mellan slag och radbrytningar!)</P>

        <BLOCKQUOTE>
          <P>&lt;TEXTAREA NAME=&quot;mintext&quot; COLS=&quot;30&quot;<BR>
          &nbsp; ROWS=&quot;3&quot;&gt;Exempel&lt;/TEXTAREA&gt;</P>

          <FORM>
            <P><TEXTAREA NAME="mintext" COLS="30" ROWS="3">Exempel</TEXTAREA></P>
          </FORM>
          <P>&nbsp;</P>
        </BLOCKQUOTE>

        <H4>List- och kombinationsrutor (&lt;SELECT&gt; och &lt;OPTION&gt;)</H4>

        <P>Precis som med textfältet så har list- och kombinationsrutor en
        öppnande och avslutande tagg. Och för varje alternativ i rutan så
        används taggen &lt;OPTION&gt;. OPTION-taggens attribut VALUE kan
        användas för att skicka ett annat värde än det som visas för
        besökaren.</P>

        <P>Nedan visas två exempel på hur man skapar en kombinationsruta i
        HTML-kod. I det första exemplet visas en kombinationsruta och i det andra
        exemplet en listruta. För att få en kombinationsruta kan man utelämna
        attributet SIZE och om man vill ha en listruta istället, så anger man
        ett värde större än 1 för attributet SIZE (t.ex. SIZE=&quot;4&quot;).</P>

        <BLOCKQUOTE>
          <P>&lt;SELECT NAME=&quot;minlista&quot;&gt;<BR>
          &nbsp; &lt;OPTION VALUE=&quot;1&quot;&gt;Alternativ 1&lt;/OPTION&gt;<BR>
          &nbsp; &lt;OPTION VALUE=&quot;2&quot;&gt;Alternativ 2&lt;/OPTION&gt;<BR>
          &nbsp; &lt;OPTION VALUE=&quot;3&quot;&gt;Alternativ 3&lt;/OPTION&gt;<BR>
          &lt;/SELECT&gt;</P>

          <FORM>
            <P><SELECT SIZE="1" NAME="D1">
            <OPTION VALUE="1" SELECTED>Alternativ 1</OPTION>
            <OPTION VALUE="2">Alternativ 2</OPTION>
            <OPTION VALUE="3">Alternativ 3</OPTION>
            &nbsp;
            </SELECT></P>
          </FORM>
          <P>&lt;SELECT NAME=&quot;minlista&quot; SIZE=&quot;4&quot;&gt;<BR>
          &nbsp; &lt;OPTION VALUE=&quot;1&quot;&gt;Alternativ 1&lt;/OPTION&gt;<BR>
          &nbsp; &lt;OPTION VALUE=&quot;2&quot;&gt;Alternativ 2&lt;/OPTION&gt;<BR>
          &nbsp; &lt;OPTION VALUE=&quot;3&quot;&gt;Alternativ 3&lt;/OPTION&gt;<BR>
          &lt;/SELECT&gt;</P>

          <FORM>
            <P><SELECT SIZE="4" NAME="D1">
            <OPTION VALUE="1" SELECTED>Alternativ 1</OPTION>
            <OPTION VALUE="2">Alternativ 2</OPTION>
            <OPTION VALUE="3">Alternativ 3</OPTION>
            &nbsp;
            </SELECT></P>
          </FORM>
        </BLOCKQUOTE>

        <H3>Submit-knappen</H3>

        <P>Submit-knappen är egentligen en &quot;vanlig&quot; kontroll med
        fördefinerat beteende, d.v.s. att skicka iväg formulärets innehåll
        till webbservern. Det finns även en knapp till som brukar användas i
        kombination med Submit-knappen - Reset-knappen. Reset-knappen
        återställer (tömmer) formuläret till de värden som kontrollerna
        innehåll när webbsida med formuläret laddades.</P>

        <P>Submit-knappen skapas med en INPUT-tagg vars attribut TYPE satts till
        &quot;submit&quot;. Texten som ska visas på knappen anges med attributet
        VALUE. Nedan visas HTML-koden som behövs för att skapa en Submit-knapp.</P>

        <BLOCKQUOTE>
          <P><SPAN CLASS="kod">&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Skicka
          formulär&quot;&gt;</SPAN></P>
          <form method="POST" action="../../../../../_vti_bin/shtml.dll/personal/bpn01/www/asp/formular/index.html" onSubmit="" webbot-action="--WEBBOT-SELF--">
            <!--WEBBOT BOT="SaveResults" startspan
            U-File="../../../_private/form_results.txt" S-Format="TEXT/CSV"
            S-Label-Fields="TRUE" --><strong>[FrontPage-komponenten Spara resultat]</strong><!--WEBBOT
            bot="SaveResults" endspan i-checksum="16328" -->
            <p><input type="submit" value="Skicka formulär" name="B1"></p>
          </form>
        </BLOCKQUOTE>

        <H3>Ett enkelt formulär</H3>

        <P>HTML-koden som har med formuläret att göra har markerat med fet stil.</P>

        <P><SPAN CLASS="kodlangre">&lt;HTML&gt;<BR>
        &lt;HEAD&gt;<BR>
        &nbsp; &lt;TITLE&gt;Ett enkelt formulär&lt;/TITLE&gt;<BR>
        &lt;/HEAD&gt;<BR>
        &lt;BODY&gt;</SPAN></P>
        <P><SPAN CLASS="kodlangre">&lt;H1&gt;Ett enkelt formulär&lt;/H1&gt;<BR>
        &lt;P&gt;Fyll i fälten och klicka på Skicka för att skicka
        informationen&lt;/P&gt;</SPAN></P>
        <P><SPAN CLASS="kodlangre"><B>&lt;FORM METHOD=&quot;post&quot; ACTION=&quot;registrera.asp&quot;&gt;</B><BR>
        &nbsp; &lt;P&gt;Namn:&nbsp;&nbsp; <B>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;namn&quot;&gt;</B>&lt;/P&gt;<BR>
        &nbsp; &lt;P&gt;E-post: <B> &lt;INPUT TYPE=&quot;text&quot; NAME=&quot;epost&quot;&gt;</B>&lt;/P&gt;<BR>
        &nbsp; &lt;P&gt;<B>&lt;INPUT TYPE=&quot;Submit&quot; VALUE=&quot;Skicka&quot;&gt;</B>&lt;/P&gt;<BR>
        <B>
        &lt;/FORM&gt;</B></SPAN></P>
        <P><SPAN CLASS="kodlangre">&lt;/BODY&gt;<BR>
        &lt;/HTML&gt;</SPAN></P>

        <h3>Microsoft FrontPage och Visual InterDev</h3>

        <p>Givetvis går det lite lättare att skapa formulär om man använder
        verktyg för att redigera webbsidor visuellt. Microsoft FrontPage 2000 och
        Visual InterDev 6 är två sådana verktyg som är lämpliga då man
        jobbar med Microsoft teknologier (därmed inte sagt att de är de bästa
        för utveckling av webbsidor :-).</p>

        <p>FrontPage är bäst (av de två) för att utveckla utseendet för
        webbsidorna, medan Visual InterDev är bättre då man skriver ASP- och
        JavaScript-kod. För formulär är också FrontPage bäst då så fort man
        placerar en kontroll på webbsidan så lägger FrontPage till FORM-taggen
        samt Submit- och Reset-knappar.</p>

        <hr>
        <p style="text-align: center;">| <a href="#borjan">Till början</a> på sida |</p>
        <hr>

        <H2><A NAME="hamta"></A>Hämta information från formulär</H2>

        <P>Här beskrivs hur man hämtar informationen från ett formulär som
        skickats till ASP-sidan. Tyvärr finns (ännu?) inget bra verktyg för att
        generera kod för att läsa innehållet från ett formulär. Vi måste
        alltså skriva koden själv.</P>

        <P>För att webbserver ska veta att en webbsida innehåller ASP-kod (och
        kunna tolka den) måste filen med webbsidan ha filändelsen .ASP.</P>

        <h3>Objektet Request</h3>

        <P>All information (data?) som skickas från en webbläsare när den
        (eller snarare besökaren) begär en webbsida placeras i objektet Request.
        Från detta objekt kan vi sen i vår ASP-kod hämta bl.a. innehållet
        från formulär. Objektet finns alltid tillgängligt och behöver alltså
        inte skapas.</P>

        <P>Beroende på hur formuläret skickades, get eller post, så finns det
        två vektorer som innehåller innehållet från formuläret - QueryString
        respektive Form. För att hämta innehållet i ett formulär som skickats
        med metoden get så använder vi alltså vektorn QueryString i
        Request-objektet</P>

        <blockquote>
          <P><SPAN CLASS="kod">Request.QueryString(&quot;namn_på_kontroll&quot;)</SPAN></P>
        </blockquote>

        <P>Om vi istället skickar formuläret med metoden post så använder vi
        vektorn Form</P>

        <blockquote>
          <P><SPAN CLASS="kod">Request.Form(&quot;namn_på_kontroll&quot;)</SPAN></P>
        </blockquote>

        <P>Att hantera innehållet från exempelformuläret ovan (Ett enkelt
        formulär) kan ske med nedanstående kod (eftersom formuläret skickas med
        metoden post). Här deklareras först två variabler som sedan tilldelas
        innehållet från textkontrollerna namn och epost.</P>

        <blockquote>
          <P><SPAN CLASS="kod">Dim strNamn, strEpost<br>
          strNamn = Request.Form(&quot;namn&quot;)<br>
          strEpost = Request.Form(&quot;epost&quot;)</SPAN></P>
        </blockquote>

        <h3>Skriva till webbsida</h3>

        <P>Givetvis är det inte bara intressant att läsa data från ett
        formulär, utan kommunikation sker ofta år andra hållet med utskrift.
        För att skriva till den resulterande webbsidan använder vi istället
        objektet Response, även det alltid tillgängligt. Metoden vi använder
        är Write() och i nedanstående kod (som fortsätter från den ovan)
        skriver ut innehållet i variablerna efter lite ledtext.</P>

        <BLOCKQUOTE>
          <P><SPAN CLASS="kod">&lt;%<BR>
          &nbsp; Response.Write &quot;Du angav ditt namn som: &quot;
          &amp; strNamn<br>
          &nbsp; Response.Write &quot; och din e-postadress som: &quot; &amp; strEpost<BR>
          %&gt;</SPAN></P>
        </BLOCKQUOTE>

        <P>Eftersom ASP-sidan är så enkel (liksom formuläret) så skulle vi
        kunna ersätta ovanstående två rader med följande kod.</P>

        <BLOCKQUOTE>
          <P>Du angav ditt namn som: <SPAN CLASS="kod">&lt;% =strNamn %&gt;</SPAN> och
            din e-postadress som: <SPAN CLASS="kod">&lt;% =strEpost %&gt;</SPAN></P>
        </BLOCKQUOTE>

        <P>Det sista alternativet är ibland att föredra då det gör det
        lättare att läsa HTML-koden (liksom ASP-koden), speciellt om mängden
        &quot;utskrifter&quot; år små. Man använder ASP-koden för att hantera
        logiken och HTML-koden för presentation.&nbsp;</P>

        <P CLASS="kommentar">Egentligen så bör man
        använda komponenter för att hantera det mesta av logiken samt ASP endast
        för att anropa metoder i komponenterna och eventuell utskrift av
        resultatet från metodanropen. Se <A HREF="../komponenter/index.html">ASP och
        komponenter</A> för mer information.</P>

        <hr>
        <p style="text-align: center;">| <a href="#borjan">Till början</a> på sida |</p>
        <hr>

        <H2><A NAME="storre"></A>Ett lite större exempel</H2>

        <P>I detta exempel använder vi två filer:</P>

        <UL>
          <LI>STORRE1.HTM - innehåller HTML-formuläret</LI>
          <LI>STORRE1.ASP - innehåller ASP-koden som hanterar innehållet från
            formuläret</LI>
        </UL>

        <P>&nbsp;</P>

        <H3>Förklaring till koden i filen STORRE1.HTM</H3>

        <P>HTML-koden för formuläret är inte mycket mer komplex än den i det
        enkla exemplet ovan. Men tabellen som används för att styra bredden på
        textraderna och för att kunna centrar webbsidans innehåll gör att koden
        ser värre ut än den är. Men koden för tabellen skapas relativt enkelt
        i t.ex. Microsoft FrontPage.</P>

        <P>Formuläret i detta exempel innehåller bl.a. två textrutor och en
        Submit-knapp. Men här visas även hur man använder radioknappar och
        textrutor i HTML-formulär (samt hur man hanterar dess innehåll nedan).</P>

        <H4>Radioknappar</H4>

        <P>Radioknappar brukar användas i grupper om två eller fler - besökaren
        kan då endast markera en av radioknapparna. För att gruppera
        radioknapparna så ger man dem samma värde på INPUT-taggens attribut
        NAME. Och för att skicka olika värden, beroende på vilken radioknapp
        som besökaren valde, så använder man attributet VALUE. Attributet
        CHECKED (utan något värde efter ett likhetstecken!) används för att
        avgöra vilken radioknapp (om någon) som ska vara markerad när webbsida
        med formulär laddas.</P>

        <P>I detta exempel använder vi två radioknappar för att besökare ska
        kunna ange om han/hon är en student eller lärare. Radioknappen ges
        namnet sysselsattning och värdena &quot;studerande&quot; respektive
        &quot;larare&quot;. Observera att svenska tecken har ersatts med
        bokstäverna a eller o. Efter radioknappen skrivs ledtext för att visa
        på vilket alternativ som radioknappen avser.</P>

        <BLOCKQUOTE>
          <P><SPAN CLASS="kod">&lt;P&gt;Jag är:<BR>
              <B>&lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;sysselsattning&quot;<BR>
              &nbsp; VALUE=&quot;studerande&quot; CHECKED&gt;</B>studerande<BR>
              <B>&lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;sysselsattning&quot;<BR>
              &nbsp; VALUE=&quot;larare&quot;&gt;</B>lärare&lt;/P&gt;&nbsp;</SPAN></P>

          <FORM>
          <P>Jag är: <INPUT TYPE="radio" NAME="sysselsattning" VALUE="studerande" CHECKED>studerande
              <INPUT TYPE="radio" NAME="sysselsattning" VALUE="larare">lärare
          </P>
          </FORM>
        </BLOCKQUOTE>

        <H4>Kryssrutor</H4>

        <P>Kryssrutor brukar, i motsats till radioknappar, kunna anges oberoende
        av varandra, d.v.s. används för att markera inga eller flera alternativ.&nbsp;Om
        vi bara anger namnet på kontroller (med attributet NAME) så kommer
        värdet &quot;on&quot; skickas om besökare markerat kryssrutan. Vill vi
        skicka något mer intressant värde (än &quot;on&quot;) så kan vi
        använda attributet VALUE. Även här kan vi använda attributet CHECKED
        för att låta en (eller flera) kryssrutor vara markerade när webbsida
        laddas.</P>

        <P><B>Observera</B> även att kryssrutans namn (och därmed innehåll)
        endast skickas om kryssrutan har markerats!</P>

        <BLOCKQUOTE>
        <P>&lt;P&gt;Jag vill ha information om:<BR>
        &nbsp;
              <B>&lt;INPUT TYPE=&quot;checkbox&quot; NAME=&quot;bocker&quot;&gt;</B>läroböcker<BR>
        &nbsp;
              <B>&lt;INPUT TYPE=&quot;checkbox&quot; NAME=&quot;program&quot;&gt;</B>program&lt;/P&gt;</P>

        <FORM>
        <P>Jag vill ha information om:
              <INPUT TYPE="checkbox" NAME="bocker">läroböcker
              <INPUT TYPE="checkbox" NAME="program">program</P>
        </FORM>
        </BLOCKQUOTE>

        <H4>Fullständiga koden för filen STORRE1.HTM</H4>

        <P>Koden för HTML-formuläret har markerats med fet stil i koden nedan.</P>

        <PRE>&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Ett större exempel med formulär&lt;/TITLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;

  &lt;!-- Centrera tabell --&gt;
  &lt;DIV ALIGN=&quot;center&quot;&gt;
  &lt;CENTER&gt;

    &lt;!-- Tabell används för att styra bredd på text och för att kunna
        centrera. Tabellen innehåller endast en rad och en kolumn --&gt;
    &lt;TABLE BORDER=&quot;0&quot; WIDTH=&quot;600&quot;&gt;
      &lt;TR&gt;
        &lt;TD WIDTH=&quot;100%&quot;&gt;

          &lt;H1&gt;Ett större exempel med formulär&lt;/H1&gt;
          &lt;P&gt;I detta exempel visas ett formulär i filen STORRE1.HTM
            och som skickar innehållet till en fil med namnet
            STORRE1.ASP.&lt;/P&gt;

          &lt;HR&gt;

          &lt;!-- START: Formulär --&gt;
          <B>&lt;FORM METHOD=&quot;post&quot; ACTION=&quot;storre1.asp&quot;&gt;</B>

            &lt;P&gt;Förnamn&lt;BR&gt;
              <B>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;fnamn&quot;&gt;</B>&lt;/P&gt;

            &lt;P&gt;Efternamn&lt;BR&gt;
              <B>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;enamn&quot;&gt;</B>&lt;/P&gt;

            &lt;P&gt;Jag är:
              <B>&lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;sysselsattning&quot;
                VALUE=&quot;studerande&quot; CHECKED&gt;</B>studerande
              <B>&lt;INPUT TYPE=&quot;radio&quot; NAME=&quot;sysselsattning&quot;
                VALUE=&quot;larare&quot;&gt;</B>lärare&lt;/P&gt;

            &lt;P&gt;Jag vill ha information om:
              <B>&lt;INPUT TYPE=&quot;checkbox&quot; NAME=&quot;bocker&quot;&gt;</B>läroböcker
              <B>&lt;INPUT TYPE=&quot;checkbox&quot; NAME=&quot;program&quot;&gt;</B>program&lt;/P&gt;

            &lt;P&gt;&lt;<B>INPUT TYPE=&quot;submit&quot; VALUE=&quot;Skicka!&quot;&gt;</B>&lt;/P&gt;

          <B>&lt;/FORM&gt;</B>
          &lt;!-- SLUT: Formulär --&gt;

          &lt;HR&gt;

        &lt;/TD&gt;
      &lt;/TR&gt;
    &lt;/TABLE&gt;

  &lt;/CENTER&gt;
  &lt;/DIV&gt;

  &lt;/BODY&gt;
  &lt;/HTML&gt;</PRE>

        <H3>Förklaring till koden i filen STORRE1.ASP</H3>

        <P>HTML-koden är i stort sett den samma i denna fil som i den med
        HTML-formuläret, bortsett från att den inte innehåller ett formulär.
        ASP-koden har delats upp i två delar där den första delen deklarerar
        variabler och hämtar innehållet från formuläret. Denna del har
        placerats innan den öppnande HTML-taggen.</P>

        <P>Den andra delen av ASP-koden har placerats i webbsidans kropp (d.v.s. i
        BODY-taggen) för att utskrift ska kunna ske direkt där den ska användas
        (med Response.Write).</P>

        <P>En viktig sak, som ganska tydligt framkommer i detta exempel, är det
        flitiga användandet av If-satser i ASP-kod. Innehåll från formulär måste
        kontrolleras ganska ingående så att det inte genereras några fel i
        ASP-koden.</P>

        <P CLASS="kommentar">Helst av allt så bör man använda JavaScript-kod för att validera
        formuläret <B>innan</B> formuläret skickas till webbservern och
        ASP-sidan. Med validering menas att man kontrollerar att alla
        obligatoriska fält innehåller något, och gärna då giltiga värden.
        Men JavaScript ligger är utanför ämnet för denna webbsida.</P>

        <H4>ASP-kod del 1</H4>

        <P>I första delen av ASP-koden deklareras en variabel blnSkickat som en
        flagga som används för att avgöra om resten av koden ska exekveras. (Det
        finns inget skäl att exekvera någon kod om det inte finns något att
        göra. :-) Genom att kontrollera om egenskapen Count i vektorn
        Request.Form är större än noll (0) så kan flaggan (variablen
        blnSkickat) sätts till sant, annars falskt. Flaggan används även i den
        andra delen av ASP-koden.</P>

        <BLOCKQUOTE>
          <P><SPAN CLASS="kod">If Request.Form.Count &gt; 0 Then<BR>
          &nbsp; blnSkickat = True<BR>
          Else<BR>
          &nbsp; blnSkickat = False<BR>
          End If</SPAN></P>
        </BLOCKQUOTE>

        <P>Och om något skickats så deklarerar vi variabler för att lagra
        innehållet i formuläret samt hämtar och tilldelar innehållet till
        variablerna. Det är ingen skillnad mot det enkla exemplet ovan.</P>

        <H4>ASP-kod del 2&nbsp;</H4>

        <P>Det första vi gör att kontrollera att något skickats genom att
        använda vår flagga blnSkickat. Efter lite ledtext så&nbsp;skriver vi ut
        besökarens för- och efternamn. Inte heller detta är något nytt
        jämfört med det enkla exemplet ovan.</P>

        <H5>Radioknappar och kryssrutor</H5>

        <P>Däremot så skiljer sig hanteringen av innehållet i radioknappar och
        kryssrutor. Som nämnts ovan så kan man (med diverser attribut i
        INPUT-taggen) styra vad som ska skickas när besökare väljer en
        radioknapp eller sätter en bock i en kryssruta. I HTML-formuläret har
        jag valt att skicka beskrivande strängar från radioknapparna men endast
        värdet &quot;on&quot; om besökare markerar en kryssruta.</P>

        <P>Eftersom radioknappen för sysselsättningen &quot;lärare&quot;
        innehåller svenska tecken (bokstaven ä för att vara exakt) så har jag
        valt att skickat texten &quot;larare&quot; istället. Därmed måste jag
        kontrollera om besökarens sysselsättning är studerande (alt. lärare)
        eller inte och sen skriva ut besökarens sysselsättning. (Det vore
        bättre att endast skicka en bokstav, d.v.s. &quot;s&quot; och &quot;l&quot;, 
        men exemplet visar ju på problemet.)</P>

        <BLOCKQUOTE>
        <P><SPAN CLASS="kod">If strSysselsattning = &quot;studerande&quot; Then<BR>
        &nbsp; Response.Write &quot;studerande&quot;<BR>
        Else<BR>
        &nbsp; Response.Write &quot;lärare&quot;<BR>
        End If</SPAN></P>
        </BLOCKQUOTE>

        <P>Kryssrutorna skapar lite mer problem, men problemet är främst
        relaterat till att utskriften ska se bra ut (d.v.s. om texten
        &quot;och&quot; ska skrivas ut emellan &quot;intressena&quot;). Hade vi
        bara valt att spara i en databas så hade vi endast behövt kontrollerat
        om kryssrutan var vald eller inte för att skriva sant eller falskt till
        fältet i databasen. Men eftersom jag valt att göra en &quot;snygg&quot;
        utskrift så måste jag kontrollera om kryssrutorna är markerade, för
        att i så fall skriva ut vad besökaren är intresserad av.</P>

        <P>Om besökaren är intresserad av första alternativet (läroböcker)
        så sätter jag en flagga så att jag i nästa If-sats kan avgöra om
        texten &quot;och&quot; ska skrivas ut mellan &quot;intressena&quot;.</P>

        <BLOCKQUOTE>
        <P><SPAN CLASS="kod">If strBocker = &quot;on&quot; Then&nbsp;&nbsp;<BR>
        &nbsp; Response.Write &quot;läroböcker&quot;<BR>
        &nbsp; blnBocker = True<BR>
        End If<BR>
        <BR>
        If strProgram = &quot;on&quot; Then<BR>
        &nbsp; If blnBocker then<BR>
        &nbsp;&nbsp;&nbsp; Response.Write &quot; och
        &quot;<BR>
        &nbsp; End If<BR>
        <BR>
        &nbsp;&nbsp;Response.Write &quot;program&quot;<BR>
        End If</SPAN></P>
        </BLOCKQUOTE>

        <P>Detta större, men relativt enkla, exempel slutat med ca 100 rader med
        HTML- och ASP-kod (inklusive tomma rader och kommentarer!). Ska sanningen
        fram så bidrar &quot;designen&quot; (tabellen) för webbsidan med ca 25
        rader av koden. Men 75 rader för att hantera och skriva ut 5 kontroller
        är kanske inte så &quot;produktivt&quot;...&nbsp;</P>

        <H4>Fullständig kod för filen STORRE1.ASP&nbsp;</H4>

        <P>ASP-koden har markerats med fet stil (utom kommentarer)&nbsp;</P>

        <PRE><B>&lt;%
    Option Explicit

      </B>'Deklarera variabler<B>
    Dim blnSkickat

      </B>'Om formulär skickats och är ifyllt - sätt flagga till sant<B>
    If Request.Form.Count &gt; 0 Then
      blnSkickat = True
    Else  </B>'... annars sätt till falskt<B>
      blnSkickat = False
    End If

      </B>'Dekl. endast variabler och hämta värden om formulär skickats<B>
    If blnSkickat Then

        </B>'Deklarera variabler för innehåll i formulär <B>
      Dim strFnamn, strEnamn, strSysselsattning, strBocker, strProgram
      Dim blnBocker

        </B>'Hämta innehållet i formuläret<B>
      strFnamn = Request.Form(&quot;fnamn&quot;)
      strEnamn = Request.Form(&quot;enamn&quot;)
      strSysselsattning = Request.Form(&quot;sysselsattning&quot;)
      strBocker = Request.Form(&quot;bocker&quot;)
      strProgram = Request.Form(&quot;program&quot;)

    End If
  %&gt;</B></PRE>
        <PRE>&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Ett större exempel med formulär&lt;/TITLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;

  &lt;!-- Centrera tabell --&gt;
  &lt;DIV ALIGN=&quot;center&quot;&gt;
  &lt;CENTER&gt;

    &lt;!-- Tabell används för att styra bredd på text och för att kunna
        centrera. Tabellen innehåller endast en rad och en kolumn --&gt;
    &lt;TABLE BORDER=&quot;0&quot; WIDTH=&quot;600&quot;&gt;
      &lt;TR&gt;
        &lt;TD WIDTH=&quot;100%&quot;&gt;

          &lt;H1&gt;Ett större exempel med formulär&lt;/H1&gt;
          &lt;P&gt;I denna fil, STORRE1.ASP, läses innehållet från
            formuläret i filen STORRE1.HTM och visas nedan..&lt;/P&gt;

          &lt;HR&gt;</PRE>

        <PRE><B>&lt;%
      </B>'Om formulär skickats - visa innehållet i formuläret<B>
    If blnSkickat Then

        </B>'Skriv ut lite ledtext<B>
      Response.Write &quot;&lt;P&gt;Du uppgav följande information om dig &quot;
      Response.Write &quot;själv:&lt;/P&gt;&quot;

        </B>'***********************************
  <B>      </B>'*** Skriv ut för- och efternamn ***<B>
      Response.Write &quot;&lt;P&gt;&lt;B&gt;Förnamn:&lt;/B&gt; &quot; &amp; strFnamn &amp; &quot;&lt;/P&gt;&quot;
      Response.Write &quot;&lt;P&gt;&lt;B&gt;Efternamn:&lt;/B&gt; &quot; &amp; strEnamn &amp; &quot;&lt;/P&gt;&quot;

        </B>'***********************************
  <B>      </B>'*** Skriv ut sysselsättning     ***<B>
        </B>'Påbörja HTML-stycke och skriv ut ledtext för sysselsättning<B>
      Response.Write &quot;&lt;P&gt;&lt;B&gt;Du är &lt;/B&gt;&quot;

        </B>'Om sysselsättning är stud. - skriv ut texten &quot;studerande&quot;...<B>
      If strSysselsattning = &quot;studerande&quot; Then
        Response.Write &quot;studerande&quot;
      Else  </B>'... annars texten &quot;lärare&quot;<B>
        Response.Write &quot;lärare&quot;
      End If

        </B>'Avsluta HTML-stycke<B>
      Response.Write &quot;&lt;/P&gt;&quot;

  </B><B>      </B>'***********************************
        '*** Skriv ut &quot;intressen&quot;        ***
  <B>      </B>'Påbörja HTML-stycke och skriv ut ledtext för intresse<B>
      Response.Write &quot;&lt;P&gt;&lt;B&gt;Du vill ha information om:&lt;/B&gt; &quot;

  </B><B>      </B>'Om intresserad av läroböcker - skriv ut texten &quot;läroböcker&quot;<B>
  </B><B>    If strBocker = &quot;on&quot; Then
        Response.Write &quot;läroböcker&quot;

          </B>'Sätt flagga att intresserad av böcker<B>
        blnBocker = True
      End If

        </B>'Om intresserad av program - skriv ut texten &quot;program&quot;<B>
      If strProgram = &quot;on&quot; Then

          </B>'Om även intresserad av böcker skriv ut texten &quot; och &quot;<B>
        If blnBocker then
          Response.Write &quot; och &quot;
        End If

        Response.Write &quot;program&quot;

      End If
        </B>'Avsluta HTML-stycke<B>
      Response.Write &quot;.&lt;/P&gt;&quot;

  </B><B>      </B>'***********************************
  <B>  Else   </B>'... annars meddela besökare att fylla i formuläret<B>
      Response.Write &quot;&lt;P&gt;Du måste fylla i formuläret först.&quot;
      REsponse.Write &quot; Använd länk nedan.&lt;/P&gt;&quot;
    End If
  %&gt;</B></PRE>

        <PRE>        &lt;HR&gt;
          &lt;P&gt;&lt;A HREF=&quot;storre1.htm&quot;&gt;Visa formulär&lt;/A&gt;&lt;/P&gt;
          &lt;HR&gt;</PRE>
          
        <PRE>      &lt;/TD&gt;
      &lt;/TR&gt;
    &lt;/TABLE&gt;

  &lt;/CENTER&gt;
  &lt;/DIV&gt;

  &lt;/BODY&gt;
  &lt;/HTML&gt;</PRE>

        <UL>
          <LI><A HREF="exempel/storre1.htm" TARGET="_blank">Provkör</A>
            formuläret och den hanterande ASP-koden.</LI>
        </UL>

        <hr>
        <p style="text-align: center;">| <a href="#borjan">Till början</a> på sida |
          <A HREF="../index.html">Tillbaka</A> till ASP |</p>
        <hr>

        <p style="text-align: center;"><b>Skapad av:</b> Björn G D Persson. <b>Uppdaterad:</b>
          2007-01-25.</p>
      </td>
      <td class="design-border">&nbsp;</td>
    </tr>
    <tr>
      <td class="design-border"><img height="20" src="../../bilder/vitnedrevanstra.gif" width="20" alt="BL"></td>
      <td class="design-border">&nbsp;</td>
      <td class="design-border"><img height="20" src="../../bilder/vitnedrehogra.gif" width="20" alt="BR"></td>
    </tr>
  </table>
</div>
</body>
</html>